{% extends "base.html" %}
{% load static %}
{% block content %}

<link rel="stylesheet" href="{% static 'css/AdmCss/listaDeUsuarios.css'%}">

{% include "components/adm/menuAdm.html" %}

<div class="mainListaUsuarios">
    
    <div class="divPesquisa">
        <div class="barraPesquisa">
            <img src="{% static 'img/iconeLupa.png' %}" alt="">
            <input type="search" placeholder="Pesquisar usuário">
        </div>
    </div>

        <div class="primeiraLinha">

            <h1><span>Usu</span>ários</h1>

            <div class="botoesUsuario">
            
                    <button class="addMoedas" id="addMoedas">
                        <img src="{% static 'img/iconAdicionar.png' %}" alt="">
                        Adicionar moedas
                    </button>
          

                    <button class="addUsuarios" id="addUsuarios">
                        <img src="{% static 'img/iconAdicionar.png' %}" alt="">
                        Adicionar usuário
                    </button>
            
            </div>

        </div>

        <div class="head">
            <h3>Nome</h3>
            <img src="{% static 'img/lista.png' %}" alt="">
        </div>


        <div class="listaUsuarios">

            {% for usuario in usuarios %}

            
            {% if usuario.is_active %}
            
            <div class="linhaUsuario">
                <input type="checkbox" class="checkbox">
                <div class="infoUser">
                    <img src="{% static 'img/userBlack.png' %}" alt="">
                    <input type="text" class="idUser" value="{{usuario.id}}">
                    <span class="nome">{{usuario.first_name}}</span>
                    <span>D$ {{usuario.saldo}} </span>
                    <span class="status"></span>
                    
                </div>
                <img class="iconeEditar" id="editar"
                data-id="{{usuario.id}}"  src="{% static 'img/edit.png' %}" alt="">
            </div>
    

            {% else %}

                <div class="linhaUsuario desativado">
                    <input type="checkbox" class="checkbox" disabled>
                    <div class="infoUser">
                        <input type="text" class="idUser" value="{{usuario.id}}">
                        <img src="{% static 'img/userBlack.png' %}" alt="">
                        <span class="nome">{{usuario.first_name}}</span>
                        <span class="status">Desativado</span>
                    </div>
                    <img class="iconeEditar" id="editar" data-id="{{usuario.id}}"  src="{% static 'img/edit.png' %}" alt="">
                </div>


            {% endif %}

            <dialog id="editarUsuario-{{usuario.id}}" class="editarUsuario">
                <div class="dialog-header">
                    <img src="{% static 'img/logoAdmin.png' %}" alt="LogoAdmin" class="dialog-logo">
                    <button class="close-dialog">
                        <img src="{% static 'img/iconeX.png' %}" alt="Fechar" class="close-icon">
                    </button>
                </div>
            
                <form class="formEditar">
                    {% csrf_token %}
                    <input type="hidden" class="idUser" value="{{usuario.id}}">
            
                    <div class="form-columns">
                        <div class="form-left">
                            <div class="form-group">
                                <label for="nome-{{usuario.id}}" class="form-label">Nome do Usuário</label>
                                <input type="text" id="nome-{{usuario.id}}" class="form-input nome" value="{{usuario.first_name}}">
                            </div>
            
                            <div class="form-group">
                                <label for="email-{{usuario.id}}" class="form-label">Email</label>
                                <input type="email" id="email-{{usuario.id}}" class="form-input email" value="{{usuario.username}}">
                            </div>
            
                            <div class="form-group">
                                <label for="ra-{{usuario.id}}" class="form-label">RA do Usuário</label>
                                <input type="number" id="ra-{{usuario.id}}" class="form-input ra" value="{{usuario.ra}}">
                            </div>
                        </div>
            
                        <div class="form-right">
                            <div class="form-group saldo-group">
                                <label class="form-label">Gerenciar Saldo</label>
                                <div class="saldo-control">
                                    <button type="button" class="saldo-button subtrair">
                                        <img src="{% static 'img/iconMenos.png' %}" alt="Reduzir saldo">
                                    </button>
                                    <input type="number" class="form-input saldo" value="{{usuario.saldo}}">
                                    <button type="button" class="saldo-button adicionar">
                                        <img src="{% static 'img/iconMais.png' %}" alt="Aumentar saldo">
                                    </button>
                                </div>
                            </div>
            
                            <div class="action-buttons">
                                <button type="button" class="action-button desativar" onclick="AtivarDesativarUser(event, false)">
                                    Desativar usuário
                                </button>
                                <button type="button" class="action-button ativar" onclick="AtivarDesativarUser(event, true)">
                                    Ativar usuário
                                </button>
                                <button type="submit" class="action-button submit">
                                    Concluído
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </dialog>
            
            <style>
                :root {
                    --laranja: #FC671D;
                    --magenta: #D34AF4;
                    --cinza: #faf6f7;
                    --cinza-escuro:#888;
                    --ciano: #0BC0D3;
                    --base: #2c006a;
                    --branco: #fff;
                    --preto: #000;
                    --roxo: #4D2C87;  
                    --sombra-base:rgba(44, 0, 106, 0.4);
                    --sombra-preta:rgba(0, 0, 0, 0.4);
                    --cinzaPlaceHolder:#9E9E9E;
                    --cinzaDatas: #D9D9D9;
                }
                .editarUsuario {
                        border: none;
                        border-radius: 8px;
                        padding: 25px;
                        width: 90%;
                        max-width: 900px;
                        background-color: var(--branco);
                        box-shadow: 0 4px 20px var(--sombra-preta);
                        color: var(--base);
                    }

                    .editarUsuario::backdrop {
                        background-color: var(--sombra-preta);
                    }

                    .dialog-header {
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        margin-bottom: 30px;
                    }

                    .close-dialog {
                        background: none;
                        border: none;
                        cursor: pointer;
                        padding: 5px;
                    }

                    .close-icon {
                        width: 32px;
                        height: 32px;
                    }

                    .form-columns {
                        display: flex;
                        gap: 50px;
                    }

                    .form-left, .form-right {
                        flex: 1;
                    }

                    .form-group {
                        margin-bottom: 25px;
                    }

                    .form-label {
                        display: block;
                        margin-bottom: 8px;
                        font-size: 16px;
                        color: var(--base);
                        font-weight: 500;
                    }

                    .form-input {
                        width: 100%;
                        padding: 12px 15px;
                        border: 1px solid var(--cinzaDatas);
                        border-radius: 4px;
                        font-size: 16px;
                        background-color: var(--branco);
                        color: var(--base);
                    }

                    .form-input:focus {
                        outline: none;
                        border-color: var(--ciano);
                    }

                    .saldo-group {
                        text-align: center;
                    }

                    .saldo-control {
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 10px;
                    }

                    .saldo-button {
                        background-color: var(--roxo);
                        border: none;
                        border-radius: 4px;
                        width: 32px;
                        height: 32px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        cursor: pointer;
                        padding: 0;
                    }

                    .saldo-button:hover {
                        background-color: var(--base);
                    }

                    .saldo-control input {
                        width: 100px;
                        text-align: center;
                    }

                    .action-buttons {
                        display: flex;
                        flex-direction: column;
                        gap: 15px;
                        margin-top: 30px;
                    }

                    .action-button {
                        padding: 14px;
                        border: none;
                        border-radius: 20px;
                        font-size: 16px;
                        font-weight: 600;
                        cursor: pointer;
                        color: var(--branco);
                        transition: background-color 0.3s;
                    }

                    .desativar {
                        background-color: var(--magenta);
                    }

                    .desativar:hover {
                        background-color: rgb(167, 49, 120);
                    }

                    .ativar {
                        background-color: var(--ciano);
                    }

                    .ativar:hover {
                        background-color: rgb(7, 122, 134);
                    }

                    .submit {
                        background-color: var(--laranja);
                        margin-top: 20px;
                    }

                    .submit:hover {
                        background-color: #e05a1a;
                    }

                    /* Responsividade */
                    @media (max-width: 768px) {
                        .form-columns {
                            flex-direction: column;
                            gap: 20px;
                        }
                        
                        .form-left, .form-right {
                            width: 100%;
                        }
                    }
            </style>

            {% endfor%} 
        </div>
</div>

<dialog id="popupCadastrarUsuario" class="popupCadastrarUsuario">
    {% include "AdmHtml/cadastrarUsuario.html" %}
</dialog>

<dialog id="popupAdicionarMoedas" class="popupAdicionarMoedas">
    {% include "AdmHtml/adicionarMoedas.html" %}
</dialog>


<script src="{% static 'js/AdmJS/listaDeUsuarios.js' %}"></script>
{% endblock %}